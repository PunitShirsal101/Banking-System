@startuml SystemContext
' Senior-level System Context for Banking System
skinparam backgroundColor #FFFFFF
skinparam componentStyle rectangle
skinparam wrapWidth 200
left to right direction

actor Customer as customer
actor "Backoffice User" as backoffice
actor "External Payment Network" as externalNet
actor "Card Scheme" as cardScheme
actor "3rd-party Services" as thirdParty

package "Banking System" {
  [API Gateway]
  [AuthZ Service]
  [Accounts Service]
  [Customers Service]
  [Cards Service]
  [Payments Service]
  [Transfers Service]
  [Ledger Service]
  [Statements Service]
  [Notifications Service]
  [Discovery Server]
  [Config Server]
  [Event Bus]
}

customer --> [API Gateway] : Mobile/Web requests
backoffice --> [API Gateway] : Admin/Support portal
[API Gateway] --> [AuthZ Service] : OAuth2/OIDC: token introspection
[API Gateway] --> [Discovery Server] : Service lookup
[API Gateway] --> [Config Server] : Bootstrapping configs

[API Gateway] --> [Accounts Service]
[API Gateway] --> [Customers Service]
[API Gateway] --> [Cards Service]
[API Gateway] --> [Payments Service]
[API Gateway] --> [Transfers Service]
[API Gateway] --> [Ledger Service]
[API Gateway] --> [Statements Service]

[Payments Service] --> [Event Bus] : Domain Events (PaymentInitiated, PaymentSettled)
[Transfers Service] --> [Event Bus] : Domain Events (TransferRequested, TransferCompleted)
[Ledger Service] --> [Event Bus] : Domain Events (EntryPosted)
[Notifications Service] <- [Event Bus] : Subscribes to events
[Statements Service] <- [Event Bus] : Subscribes for materialized views

[Payments Service] --> externalNet : Clearing/Settlement
[Cards Service] --> cardScheme : Tokenization/Authorization
[Accounts Service] --> thirdParty : KYC, AML, Credit Bureau

@enduml